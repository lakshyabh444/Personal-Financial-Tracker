<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Finance Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.4/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15);
        }

        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3rem;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 8px 15px;
            font-size: 14px;
        }

        .btn-danger:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(255, 107, 107, 0.4);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .transactions-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e1e5e9;
            transition: background-color 0.3s ease;
        }

        .transaction-item:hover {
            background-color: #f8f9fa;
        }

        .transaction-info {
            flex-grow: 1;
        }

        .transaction-description {
            font-weight: 600;
            color: #333;
            margin-bottom: 3px;
        }

        .transaction-category {
            font-size: 0.9rem;
            color: #666;
        }

        .transaction-amount {
            font-weight: 700;
            font-size: 1.1rem;
        }

        .expense {
            color: #e74c3c;
        }

        .income {
            color: #27ae60;
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-top: 20px;
        }

        .budget-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-bottom: 1px solid #e1e5e9;
        }

        .budget-progress {
            width: 100%;
            height: 8px;
            background-color: #e1e5e9;
            border-radius: 4px;
            margin: 8px 0;
            overflow: hidden;
        }

        .budget-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #27ae60 0%, #2ecc71 100%);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .budget-progress-bar.over-budget {
            background: linear-gradient(90deg, #e74c3c 0%, #c0392b 100%);
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 5px solid;
        }

        .alert-warning {
            background-color: #fff3cd;
            border-color: #ffc107;
            color: #856404;
        }

        .alert-danger {
            background-color: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }

        .tabs {
            display: flex;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 5px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .transaction-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Mock Database (In real app, this would be PostgreSQL with proper API)
        class MockDatabase {
            constructor() {
                this.users = JSON.parse(localStorage.getItem('users') || '[]');
                this.transactions = JSON.parse(localStorage.getItem('transactions') || '[]');
                this.budgets = JSON.parse(localStorage.getItem('budgets') || '[]');
                this.currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            }

            save() {
                localStorage.setItem('users', JSON.stringify(this.users));
                localStorage.setItem('transactions', JSON.stringify(this.transactions));
                localStorage.setItem('budgets', JSON.stringify(this.budgets));
                localStorage.setItem('currentUser', JSON.stringify(this.currentUser));
            }

            addTransaction(transaction) {
                const newTransaction = {
                    ...transaction,
                    id: Date.now().toString(),
                    userId: this.currentUser?.id,
                    date: new Date().toISOString()
                };
                this.transactions.push(newTransaction);
                this.save();
                return newTransaction;
            }

            getTransactions() {
                return this.transactions.filter(t => t.userId === this.currentUser?.id);
            }

            deleteTransaction(id) {
                this.transactions = this.transactions.filter(t => t.id !== id);
                this.save();
            }

            addBudget(budget) {
                const newBudget = {
                    ...budget,
                    id: Date.now().toString(),
                    userId: this.currentUser?.id
                };
                this.budgets.push(newBudget);
                this.save();
                return newBudget;
            }

            getBudgets() {
                return this.budgets.filter(b => b.userId === this.currentUser?.id);
            }

            updateBudget(id, updates) {
                const index = this.budgets.findIndex(b => b.id === id);
                if (index !== -1) {
                    this.budgets[index] = { ...this.budgets[index], ...updates };
                    this.save();
                }
            }

            deleteBudget(id) {
                this.budgets = this.budgets.filter(b => b.id !== id);
                this.save();
            }

            login(username, password) {
                const user = this.users.find(u => u.username === username && u.password === password);
                if (user) {
                    this.currentUser = user;
                    this.save();
                    return true;
                }
                return false;
            }

            register(username, password, email) {
                if (this.users.find(u => u.username === username)) {
                    return false; // User exists
                }
                const newUser = {
                    id: Date.now().toString(),
                    username,
                    password,
                    email
                };
                this.users.push(newUser);
                this.currentUser = newUser;
                this.save();
                return true;
            }

            logout() {
                this.currentUser = null;
                this.save();
            }
        }

        const db = new MockDatabase();

        // Chart Component
        const ExpenseChart = ({ transactions }) => {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                if (chartInstance.current) {
                    chartInstance.current.destroy();
                }

                const ctx = chartRef.current.getContext('2d');
                
                // Group transactions by category
                const categoryData = transactions.reduce((acc, transaction) => {
                    if (transaction.type === 'expense') {
                        acc[transaction.category] = (acc[transaction.category] || 0) + parseFloat(transaction.amount);
                    }
                    return acc;
                }, {});

                const labels = Object.keys(categoryData);
                const data = Object.values(categoryData);
                const colors = [
                    '#FF6B6B', '#4ECDC4', '#45B7D1', '#96CEB4', '#FFEAA7',
                    '#DDA0DD', '#98D8C8', '#F7DC6F', '#BB8FCE', '#85C1E9'
                ];

                if (labels.length === 0) {
                    // Show empty state
                    chartInstance.current = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: ['No Data'],
                            datasets: [{
                                data: [1],
                                backgroundColor: ['#e1e5e9'],
                                borderWidth: 0
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            }
                        }
                    });
                } else {
                    chartInstance.current = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: labels,
                            datasets: [{
                                data: data,
                                backgroundColor: colors.slice(0, labels.length),
                                borderWidth: 2,
                                borderColor: '#fff'
                            }]
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            plugins: {
                                legend: {
                                    position: 'bottom',
                                    labels: {
                                        padding: 20,
                                        usePointStyle: true
                                    }
                                }
                            }
                        }
                    });
                }

                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                };
            }, [transactions]);

            return <canvas ref={chartRef}></canvas>;
        };

        // Login Component
        const LoginForm = ({ onLogin }) => {
            const [isLogin, setIsLogin] = useState(true);
            const [username, setUsername] = useState('');
            const [password, setPassword] = useState('');
            const [email, setEmail] = useState('');
            const [error, setError] = useState('');

            const handleSubmit = (e) => {
                e.preventDefault();
                setError('');

                if (isLogin) {
                    if (db.login(username, password)) {
                        onLogin();
                    } else {
                        setError('Invalid username or password');
                    }
                } else {
                    if (db.register(username, password, email)) {
                        onLogin();
                    } else {
                        setError('Username already exists');
                    }
                }
            };

            return (
                <div className="container" style={{display: 'flex', justifyContent: 'center', alignItems: 'center', minHeight: '100vh'}}>
                    <div className="card" style={{width: '400px'}}>
                        <h3 style={{textAlign: 'center', marginBottom: '30px'}}>
                            {isLogin ? 'Login to Your Account' : 'Create New Account'}
                        </h3>
                        
                        {error && (
                            <div className="alert alert-danger">
                                {error}
                            </div>
                        )}

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label>Username</label>
                                <input
                                    type="text"
                                    className="form-control"
                                    value={username}
                                    onChange={(e) => setUsername(e.target.value)}
                                    required
                                />
                            </div>

                            {!isLogin && (
                                <div className="form-group">
                                    <label>Email</label>
                                    <input
                                        type="email"
                                        className="form-control"
                                        value={email}
                                        onChange={(e) => setEmail(e.target.value)}
                                        required
                                    />
                                </div>
                            )}

                            <div className="form-group">
                                <label>Password</label>
                                <input
                                    type="password"
                                    className="form-control"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    required
                                />
                            </div>

                            <button type="submit" className="btn btn-primary" style={{width: '100%', marginBottom: '20px'}}>
                                {isLogin ? 'Login' : 'Sign Up'}
                            </button>
                        </form>

                        <p style={{textAlign: 'center'}}>
                            {isLogin ? "Don't have an account? " : "Already have an account? "}
                            <button 
                                style={{background: 'none', border: 'none', color: '#667eea', cursor: 'pointer', textDecoration: 'underline'}}
                                onClick={() => setIsLogin(!isLogin)}
                            >
                                {isLogin ? 'Sign Up' : 'Login'}
                            </button>
                        </p>
                    </div>
                </div>
            );
        };

        // Main Finance Tracker Component
        const FinanceTracker = () => {
            const [isLoggedIn, setIsLoggedIn] = useState(!!db.currentUser);
            const [transactions, setTransactions] = useState([]);
            const [budgets, setBudgets] = useState([]);
            const [activeTab, setActiveTab] = useState('dashboard');

            // Form states
            const [transactionForm, setTransactionForm] = useState({
                description: '',
                amount: '',
                category: '',
                type: 'expense'
            });

            const [budgetForm, setBudgetForm] = useState({
                category: '',
                limit: ''
            });

            const categories = [
                'Food & Dining', 'Transportation', 'Shopping', 'Entertainment',
                'Bills & Utilities', 'Healthcare', 'Travel', 'Education',
                'Investment', 'Salary', 'Business', 'Other'
            ];

            useEffect(() => {
                if (isLoggedIn) {
                    loadData();
                }
            }, [isLoggedIn]);

            const loadData = () => {
                setTransactions(db.getTransactions());
                setBudgets(db.getBudgets());
            };

            const handleLogin = () => {
                setIsLoggedIn(true);
                loadData();
            };

            const handleLogout = () => {
                db.logout();
                setIsLoggedIn(false);
                setTransactions([]);
                setBudgets([]);
            };

            const addTransaction = (e) => {
                e.preventDefault();
                const newTransaction = db.addTransaction(transactionForm);
                setTransactions([...transactions, newTransaction]);
                setTransactionForm({ description: '', amount: '', category: '', type: 'expense' });
            };

            const deleteTransaction = (id) => {
                db.deleteTransaction(id);
                setTransactions(transactions.filter(t => t.id !== id));
            };

            const addBudget = (e) => {
                e.preventDefault();
                const newBudget = db.addBudget(budgetForm);
                setBudgets([...budgets, newBudget]);
                setBudgetForm({ category: '', limit: '' });
            };

            const deleteBudget = (id) => {
                db.deleteBudget(id);
                setBudgets(budgets.filter(b => b.id !== id));
            };

            // Calculations
            const totalIncome = transactions
                .filter(t => t.type === 'income')
                .reduce((sum, t) => sum + parseFloat(t.amount), 0);

            const totalExpenses = transactions
                .filter(t => t.type === 'expense')
                .reduce((sum, t) => sum + parseFloat(t.amount), 0);

            const balance = totalIncome - totalExpenses;

            // Budget calculations and alerts
            const budgetAlerts = budgets.map(budget => {
                const spent = transactions
                    .filter(t => t.type === 'expense' && t.category === budget.category)
                    .reduce((sum, t) => sum + parseFloat(t.amount), 0);
                
                const percentage = (spent / parseFloat(budget.limit)) * 100;
                return { ...budget, spent, percentage };
            }).filter(b => b.percentage > 80);

            if (!isLoggedIn) {
                return <LoginForm onLogin={handleLogin} />;
            }

            return (
                <div className="container">
                    <div className="header">
                        <h1>ðŸ’° Personal Finance Tracker</h1>
                        <p>Take control of your finances with smart insights and budgeting tools</p>
                        <div style={{marginTop: '20px'}}>
                            <span style={{marginRight: '20px'}}>Welcome, {db.currentUser?.username}!</span>
                            <button className="btn btn-danger" onClick={handleLogout}>
                                Logout
                            </button>
                        </div>
                    </div>

                    {/* Budget Alerts */}
                    {budgetAlerts.map(alert => (
                        <div key={alert.id} className={`alert ${alert.percentage > 100 ? 'alert-danger' : 'alert-warning'}`}>
                            <strong>Budget Alert:</strong> You've spent {alert.percentage.toFixed(1)}% 
                            of your {alert.category} budget (${alert.spent.toFixed(2)} / ${alert.limit})
                        </div>
                    ))}

                    {/* Navigation Tabs */}
                    <div className="tabs">
                        <div 
                            className={`tab ${activeTab === 'dashboard' ? 'active' : ''}`}
                            onClick={() => setActiveTab('dashboard')}
                        >
                            ðŸ“Š Dashboard
                        </div>
                        <div 
                            className={`tab ${activeTab === 'transactions' ? 'active' : ''}`}
                            onClick={() => setActiveTab('transactions')}
                        >
                            ðŸ’³ Transactions
                        </div>
                        <div 
                            className={`tab ${activeTab === 'budgets' ? 'active' : ''}`}
                            onClick={() => setActiveTab('budgets')}
                        >
                            ðŸ“ˆ Budgets
                        </div>
                        <div 
                            className={`tab ${activeTab === 'analytics' ? 'active' : ''}`}
                            onClick={() => setActiveTab('analytics')}
                        >
                            ðŸ“Š Analytics
                        </div>
                    </div>

                    {/* Dashboard Tab */}
                    <div className={`tab-content ${activeTab === 'dashboard' ? 'active' : ''}`}>
                        {/* Statistics */}
                        <div className="stats-grid">
                            <div className="stat-card">
                                <div className="stat-value">${totalIncome.toFixed(2)}</div>
                                <div className="stat-label">Total Income</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">${totalExpenses.toFixed(2)}</div>
                                <div className="stat-label">Total Expenses</div>
                            </div>
                            <div className="stat-card" style={{background: balance >= 0 ? 'linear-gradient(135deg, #27ae60 0%, #2ecc71 100%)' : 'linear-gradient(135deg, #e74c3c 0%, #c0392b 100%)'}}>
                                <div className="stat-value">${balance.toFixed(2)}</div>
                                <div className="stat-label">Balance</div>
                            </div>
                            <div className="stat-card">
                                <div className="stat-value">{transactions.length}</div>
                                <div className="stat-label">Transactions</div>
                            </div>
                        </div>

                        {/* Recent Transactions */}
                        <div className="card">
                            <h3>Recent Transactions</h3>
                            <div className="transactions-list">
                                {transactions.slice(-5).reverse().map(transaction => (
                                    <div key={transaction.id} className="transaction-item">
                                        <div className="transaction-info">
                                            <div className="transaction-description">
                                                {transaction.description}
                                            </div>
                                            <div className="transaction-category">
                                                {transaction.category} â€¢ {new Date(transaction.date).toLocaleDateString()}
                                            </div>
                                        </div>
                                        <div className={`transaction-amount ${transaction.type}`}>
                                            {transaction.type === 'income' ? '+' : '-'}${transaction.amount}
                                        </div>
                                    </div>
                                ))}
                                {transactions.length === 0 && (
                                    <p style={{textAlign: 'center', color: '#666', padding: '40px'}}>
                                        No transactions yet. Add your first transaction!
                                    </p>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Transactions Tab */}
                    <div className={`tab-content ${activeTab === 'transactions' ? 'active' : ''}`}>
                        <div className="dashboard">
                            {/* Add Transaction Form */}
                            <div className="card">
                                <h3>Add New Transaction</h3>
                                <form onSubmit={addTransaction}>
                                    <div className="form-group">
                                        <label>Description</label>
                                        <input
                                            type="text"
                                            className="form-control"
                                            value={transactionForm.description}
                                            onChange={(e) => setTransactionForm({...transactionForm, description: e.target.value})}
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>Amount</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            className="form-control"
                                            value={transactionForm.amount}
                                            onChange={(e) => setTransactionForm({...transactionForm, amount: e.target.value})}
                                            required
                                        />
                                    </div>
                                    <div className="form-group">
                                        <label>Category</label>
                                        <select
                                            className="form-control"
                                            value={transactionForm.category}
                                            onChange={(e) => setTransactionForm({...transactionForm, category: e.target.value})}
                                            required
                                        >
                                            <option value="">Select category</option>
                                            {categories.map(cat => (
                                                <option key={cat} value={cat}>{cat}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Type</label>
                                        <select
                                            className="form-control"
                                            value={transactionForm.type}
                                            onChange={(e) => setTransactionForm({...transactionForm, type: e.target.value})}
                                        >
                                            <option value="expense">Expense</option>
                                            <option value="income">Income</option>
                                        </select>
                                    </div>
                                    <button type="submit" className="btn btn-primary">
                                        Add Transaction
                                    </button>
                                </form>
                            </div>

                            {/* All Transactions List */}
                            <div className="card">
                                <h3>All Transactions</h3>
                                <div className="transactions-list">
                                    {transactions.slice().reverse().map(transaction => (
                                        <div key={transaction.id} className="transaction-item">
                                            <div className="transaction-info">
                                                <div className="transaction-description">
                                                    {transaction.description}
                                                </div>
                                                <div className="transaction-category">
                                                    {transaction.category} â€¢ {new Date(transaction.date).toLocaleDateString()}
                                                </div>
                                            </div>
                                            <div style={{display: 'flex', alignItems: 'center', gap: '15px'}}>
                                                <div className={`transaction-amount ${transaction.type}`}>
                                                    {transaction.type === 'income' ? '+' : '-'}${transaction.amount}
                                                </div>
                                                <button 
                                                    className="btn btn-danger"
                                                    onClick={() => deleteTransaction(transaction.id)}
                                                >
                                                    Delete
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                    {transactions.length === 0 && (
                                        <p style={{textAlign: 'center', color: '#666', padding: '40px'}}>
                                            No transactions yet. Add your first transaction!
                                        </p>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Budgets Tab */}
                    <div className={`tab-content ${activeTab === 'budgets' ? 'active' : ''}`}>
                        <div className="dashboard">
                            {/* Add Budget Form */}
                            <div className="card">
                                <h3>Set Budget Limit</h3>
                                <form onSubmit={addBudget}>
                                    <div className="form-group">
                                        <label>Category</label>
                                        <select
                                            className="form-control"
                                            value={budgetForm.category}
                                            onChange={(e) => setBudgetForm({...budgetForm, category: e.target.value})}
                                            required
                                        >
                                            <option value="">Select category</option>
                                            {categories.map(cat => (
                                                <option key={cat} value={cat}>{cat}</option>
                                            ))}
                                        </select>
                                    </div>
                                    <div className="form-group">
                                        <label>Monthly Limit ($)</label>
                                        <input
                                            type="number"
                                            step="0.01"
                                            className="form-control"
                                            value={budgetForm.limit}
                                            onChange={(e) => setBudgetForm({...budgetForm, limit: e.target.value})}
                                            required
                                        />
                                    </div>
                                    <button type="submit" className="btn btn-primary">
                                        Set Budget
                                    </button>
                                </form>
                            </div>

                            {/* Budget Overview */}
                            <div className="card">
                                <h3>Budget Overview</h3>
                                {budgets.map(budget => {
                                    const spent = transactions
                                        .filter(t => t.type === 'expense' && t.category === budget.category)
                                        .reduce((sum, t) => sum + parseFloat(t.amount), 0);
                                    
                                    const percentage = (spent / parseFloat(budget.limit)) * 100;
                                    const isOverBudget = percentage > 100;

                                    return (
                                        <div key={budget.id} className="budget-item">
                                            <div style={{width: '100%'}}>
                                                <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '8px'}}>
                                                    <h4 style={{margin: 0, color: '#333'}}>{budget.category}</h4>
                                                    <div style={{display: 'flex', alignItems: 'center', gap: '15px'}}>
                                                        <span style={{color: isOverBudget ? '#e74c3c' : '#27ae60', fontWeight: 'bold'}}>
                                                            ${spent.toFixed(2)} / ${budget.limit}
                                                        </span>
                                                        <button 
                                                            className="btn btn-danger"
                                                            onClick={() => deleteBudget(budget.id)}
                                                        >
                                                            Delete
                                                        </button>
                                                    </div>
                                                </div>
                                                <div className="budget-progress">
                                                    <div 
                                                        className={`budget-progress-bar ${isOverBudget ? 'over-budget' : ''}`}
                                                        style={{width: `${Math.min(percentage, 100)}%`}}
                                                    ></div>
                                                </div>
                                                <div style={{fontSize: '0.9rem', color: '#666'}}>
                                                    {percentage.toFixed(1)}% used
                                                    {isOverBudget && (
                                                        <span style={{color: '#e74c3c', marginLeft: '10px'}}>
                                                            (Over budget by ${(spent - parseFloat(budget.limit)).toFixed(2)})
                                                        </span>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                                {budgets.length === 0 && (
                                    <p style={{textAlign: 'center', color: '#666', padding: '40px'}}>
                                        No budgets set. Create your first budget to start tracking!
                                    </p>
                                )}
                            </div>
                        </div>
                    </div>

                    {/* Analytics Tab */}
                    <div className={`tab-content ${activeTab === 'analytics' ? 'active' : ''}`}>
                        <div className="dashboard">
                            {/* Spending by Category Chart */}
                            <div className="card">
                                <h3>Spending by Category</h3>
                                <div className="chart-container">
                                    <ExpenseChart transactions={transactions} />
                                </div>
                                {transactions.filter(t => t.type === 'expense').length === 0 && (
                                    <p style={{textAlign: 'center', color: '#666', padding: '40px'}}>
                                        No expense data available. Add some expenses to see analytics!
                                    </p>
                                )}
                            </div>

                            {/* Monthly Summary */}
                            <div className="card">
                                <h3>Monthly Summary</h3>
                                <div style={{display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '20px'}}>
                                    <div>
                                        <h4 style={{color: '#27ae60', marginBottom: '10px'}}>Top Income Sources</h4>
                                        {Object.entries(
                                            transactions
                                                .filter(t => t.type === 'income')
                                                .reduce((acc, t) => {
                                                    acc[t.category] = (acc[t.category] || 0) + parseFloat(t.amount);
                                                    return acc;
                                                }, {})
                                        )
                                        .sort(([,a], [,b]) => b - a)
                                        .slice(0, 5)
                                        .map(([category, amount]) => (
                                            <div key={category} style={{display: 'flex', justifyContent: 'space-between', padding: '5px 0'}}>
                                                <span>{category}</span>
                                                <span style={{color: '#27ae60', fontWeight: 'bold'}}>+${amount.toFixed(2)}</span>
                                            </div>
                                        ))}
                                    </div>
                                    <div>
                                        <h4 style={{color: '#e74c3c', marginBottom: '10px'}}>Top Expense Categories</h4>
                                        {Object.entries(
                                            transactions
                                                .filter(t => t.type === 'expense')
                                                .reduce((acc, t) => {
                                                    acc[t.category] = (acc[t.category] || 0) + parseFloat(t.amount);
                                                    return acc;
                                                }, {})
                                        )
                                        .sort(([,a], [,b]) => b - a)
                                        .slice(0, 5)
                                        .map(([category, amount]) => (
                                            <div key={category} style={{display: 'flex', justifyContent: 'space-between', padding: '5px 0'}}>
                                                <span>{category}</span>
                                                <span style={{color: '#e74c3c', fontWeight: 'bold'}}>-${amount.toFixed(2)}</span>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                            </div>

                            {/* Financial Health Score */}
                            <div className="card">
                                <h3>Financial Health Score</h3>
                                {(() => {
                                    let score = 0;
                                    let factors = [];

                                    // Positive balance
                                    if (balance > 0) {
                                        score += 30;
                                        factors.push({ text: 'Positive balance', points: 30, positive: true });
                                    } else {
                                        factors.push({ text: 'Negative balance', points: 0, positive: false });
                                    }

                                    // Budget adherence
                                    const overBudgetCount = budgets.filter(budget => {
                                        const spent = transactions
                                            .filter(t => t.type === 'expense' && t.category === budget.category)
                                            .reduce((sum, t) => sum + parseFloat(t.amount), 0);
                                        return spent > parseFloat(budget.limit);
                                    }).length;

                                    if (budgets.length > 0) {
                                        const adherenceScore = Math.max(0, 25 - (overBudgetCount * 10));
                                        score += adherenceScore;
                                        factors.push({ 
                                            text: `Budget adherence (${budgets.length - overBudgetCount}/${budgets.length} on track)`, 
                                            points: adherenceScore, 
                                            positive: overBudgetCount === 0 
                                        });
                                    }

                                    // Transaction tracking
                                    if (transactions.length >= 10) {
                                        score += 20;
                                        factors.push({ text: 'Regular transaction tracking', points: 20, positive: true });
                                    } else if (transactions.length >= 5) {
                                        score += 10;
                                        factors.push({ text: 'Some transaction tracking', points: 10, positive: true });
                                    }

                                    // Diversified income
                                    const incomeCategories = new Set(transactions.filter(t => t.type === 'income').map(t => t.category));
                                    if (incomeCategories.size > 1) {
                                        score += 15;
                                        factors.push({ text: 'Diversified income sources', points: 15, positive: true });
                                    }

                                    // Savings rate (income vs expenses ratio)
                                    if (totalIncome > 0) {
                                        const savingsRate = (totalIncome - totalExpenses) / totalIncome;
                                        if (savingsRate > 0.2) {
                                            score += 10;
                                            factors.push({ text: 'Good savings rate (>20%)', points: 10, positive: true });
                                        }
                                    }

                                    const getScoreColor = (score) => {
                                        if (score >= 80) return '#27ae60';
                                        if (score >= 60) return '#f39c12';
                                        return '#e74c3c';
                                    };

                                    const getScoreText = (score) => {
                                        if (score >= 80) return 'Excellent';
                                        if (score >= 60) return 'Good';
                                        if (score >= 40) return 'Fair';
                                        return 'Needs Improvement';
                                    };

                                    return (
                                        <div>
                                            <div style={{textAlign: 'center', marginBottom: '30px'}}>
                                                <div style={{
                                                    fontSize: '3rem',
                                                    fontWeight: 'bold',
                                                    color: getScoreColor(score),
                                                    marginBottom: '10px'
                                                }}>
                                                    {score}/100
                                                </div>
                                                <div style={{
                                                    fontSize: '1.2rem',
                                                    color: getScoreColor(score),
                                                    fontWeight: 'bold'
                                                }}>
                                                    {getScoreText(score)}
                                                </div>
                                            </div>
                                            <div>
                                                <h4 style={{marginBottom: '15px'}}>Score Breakdown:</h4>
                                                {factors.map((factor, index) => (
                                                    <div key={index} style={{
                                                        display: 'flex',
                                                        justifyContent: 'space-between',
                                                        padding: '8px 0',
                                                        borderBottom: '1px solid #e1e5e9'
                                                    }}>
                                                        <span>{factor.text}</span>
                                                        <span style={{
                                                            color: factor.positive ? '#27ae60' : '#e74c3c',
                                                            fontWeight: 'bold'
                                                        }}>
                                                            {factor.points} pts
                                                        </span>
                                                    </div>
                                                ))}
                                            </div>
                                            <div style={{marginTop: '20px', padding: '15px', backgroundColor: '#f8f9fa', borderRadius: '10px'}}>
                                                <h5 style={{marginBottom: '10px'}}>ðŸ’¡ Tips to Improve:</h5>
                                                <ul style={{margin: 0, paddingLeft: '20px'}}>
                                                    {balance <= 0 && <li>Focus on reducing expenses or increasing income</li>}
                                                    {overBudgetCount > 0 && <li>Review and adjust budgets in over-spending categories</li>}
                                                    {transactions.length < 10 && <li>Track more transactions for better insights</li>}
                                                    {incomeCategories.size <= 1 && <li>Consider diversifying income sources</li>}
                                                    {budgets.length === 0 && <li>Set up budgets for better financial control</li>}
                                                </ul>
                                            </div>
                                        </div>
                                    );
                                })()}
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // App Component
        const App = () => {
            return <FinanceTracker />;
        };

        // Render the app
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>